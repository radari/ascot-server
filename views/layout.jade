doctype 5
html(id="ng-app", ng-app='AscotModule')
  head
    title= title

    script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js')
    script(src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js')
    script(src='http://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.js')
    script(src='/common/basic_tools.js')
    script(src='/javascripts/AngularFilters.js')
    script(src='/javascripts/services/ImageOffsetService.js')
    script(src="/javascripts/services/Redirect.js")
    script(src="/javascripts/services/Autocomplete.js")
    script(src='/javascripts/CustomDirectives.js')
    script(src='/javascripts/AscotModule.js')
    script(src='/javascripts/controllers/MainSearchBarController.js')
    script(src='/vendor/javascripts/jquery.imagesloaded.js')
    script(src='/vendor/javascripts/jquery.hoverdelay.js')
    script(src='/javascripts/navMagic.js')

    // JSON.parse and JSON.stringify for ancient browsers
    // if lt IE 8
      script(src="http://cdnjs.cloudflare.com/ajax/libs/json3/3.2.4/json3.min.js")

    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='icon', type='image/png', href='/images/favicon.ico')
    link(rel='stylesheet', href='https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/start/jquery-ui.css')
    
    block head

    script(type='text/javascript')
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36829509-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

  body

   

    #wrapper(ng-controller='MainSearchBarController')
      a#logoWrapper(href="/")
        img#logo(src='/images/ascotLogo_redo.png', id:'logo')

      ul#nav 
        li
          a(href="/upload", id="#{url.indexOf('/upload') == 0 ? 'currentPage' : 'nonCurrentPage'}")  
            h3 Start Tagging
            p Paste an image link or upload an image to start tagging.
        li#howToNav
          a(href="/howto/", id="#{url.indexOf('/howto/tumblr') == 0 ? 'currentPage' : 'nonCurrentPage'}")  
            h3 How To
            p Learn how to use the ascot plugin.
        li
          a(href="/all", id="#{url.indexOf('/all') == 0 ? 'currentPage' : 'nonCurrentPage'}")
            h3 Looks
            p See images that have already been tagged.  
        li
          - if (user)
            a(href='/home', id='nonCurrentPage')
              h3 Account
              p Manage your account. 
          - else
            a(href="/login", id="#{url.indexOf('/login') == 0 ? 'currentPage' : 'nonCurrentPage'}")
              h3 Login
              p Login to your ascot account to see your tagged images.
        li
          - if (user)
            a(href='/logout', id='nonCurrentPage')
              h3 Logout
              p Log out from #{user.username}
          - else
            
        

      br
      img#bottomStripe(src='/images/bottomStripe_long.png', id:'stripe')

      br 
      input(type='text',
            name='v',
            id='main_search',
            ng-model='mainSearch',
            ng-change='updateResults()'
            placeholder="brand or keywords",
            ng-focus="autocomplete.show('MAIN')",
            ng-blur="autocomplete.hide('MAIN')",
            ng-directional="true",
            ng-key-up="autocomplete.prevSelection('MAIN');",
            ng-key-down="autocomplete.nextSelection('MAIN');",
            ng-key-return="onSelected(autocomplete.getSelected('MAIN'));")
      span#glass 
        i
      div.autocomplete(ng-show="autocomplete.show['MAIN']")
        div(ng-repeat='result in autocomplete.results["MAIN"]',
            ng-class="autocomplete.checkSelection('MAIN', $index)",
            ng-mouseover='autocomplete.setSelection("MAIN", $index)',
            ng-click='onSelected(result)')
          span(ng-bind-html-unsafe='filterToString(result) | boldInstances:mainSearch')

      block content
    #footer  
      ul#companyInfo
        li
          a(href="/about") about-
        li
          a(href="/privacy") privacy-
        li
          a(href="/contact") contact-
        li
          a(href="/disclosures") disclosures



      ul#social
        li
          a(href="http://ascotproject.tumblr.com/", target="_blank")
            img#tumblr(src='/images/tumblrButton.png', id:'tumblrButton')
        li
          a(href="https://twitter.com/AscotProject", target="_blank")
            img#twitter(src='/images/twitterButton.png', id:'twitterButton')
        li
          a(href="https://www.facebook.com/ascotproject", target="_blank")
            img#facebook(src='/images/facebookButton.png', id:'fbButton')
  
  script(src="/vendor/javascripts/retina.js")  
